### Explotación Pública

Una vez que identificamos los servicios que se ejecutan en los puertos detectados a partir de nuestro escaneo de Nmap, el primer paso es verificar si alguna de las aplicaciones/servicios tiene alguna explotación pública disponible. Las explotaciones públicas pueden encontrarse para aplicaciones web y otros servicios que se ejecutan en puertos abiertos, como SSH o FTP.

#### Búsqueda de Explotaciones Públicas

Existen varias herramientas que pueden ayudarnos a buscar explotaciones públicas para las distintas aplicaciones y servicios que podamos encontrar durante la fase de enumeración. Una forma común es buscar en Google el nombre de la aplicación junto con la palabra "exploit" para ver si obtenemos resultados relevantes.

Una herramienta bien conocida para este propósito es **Searchsploit**, que podemos utilizar para buscar vulnerabilidades/explotaciones públicas de cualquier aplicación. Para instalarla, se puede usar el siguiente comando:


`sudo apt install exploitdb -y`

Una vez instalado, podemos utilizar **searchsploit** para buscar una aplicación específica por su nombre, como en el siguiente ejemplo:

`searchsploit openssh 7.2`

#### Ejemplo de Resultados de Búsqueda

El comando anterior podría devolver una lista de vulnerabilidades relacionadas con OpenSSH 7.2, que incluiría títulos de exploits, sus rutas y detalles adicionales:
![[Pasted image 20240929193658.png]]

#### Bases de Datos de Explotaciones Públicas

También podemos utilizar bases de datos de exploits en línea para buscar vulnerabilidades, como **Exploit DB**, **Rapid7 DB** o **Vulnerability Lab**. El módulo de Introducción a Aplicaciones Web discute las vulnerabilidades públicas para aplicaciones web.

### Introducción a Metasploit

El **Metasploit Framework (MSF)** es una herramienta excelente para los pentesters. Contiene muchos exploits incorporados para muchas vulnerabilidades públicas y proporciona una forma fácil de utilizar estos exploits contra objetivos vulnerables. MSF ofrece muchas otras características, como:

- Ejecución de scripts de reconocimiento para enumerar hosts remotos y objetivos comprometidos.
- Scripts de verificación para probar la existencia de una vulnerabilidad sin comprometer realmente el objetivo.
- **Meterpreter**, que es una herramienta efectiva para conectarse a shells y ejecutar comandos en los objetivos comprometidos.
- Muchas herramientas de post-explotación y pivotación.

#### Ejemplo Básico de Uso de Metasploit

Para ejecutar Metasploit, podemos usar el comando:

`msfconsole`

Una vez que Metasploit esté en funcionamiento, podemos buscar nuestra aplicación objetivo utilizando el comando `search exploit`. Por ejemplo, podemos buscar la vulnerabilidad de **EternalBlue** que identificamos previamente:

`msf6 > search exploit eternalblue`

Esto devolverá módulos que coincidan con la búsqueda, indicando su rango, descripción y otros detalles relevantes.

#### Configuración del Exploit

Una vez que encontremos un exploit adecuado, podemos usarlo copiando su nombre completo y utilizándolo con el comando `use`:


`msf6 > use exploit/windows/smb/ms17_010_psexec`

Antes de ejecutar el exploit, necesitamos configurar sus opciones. Para ver las opciones disponibles, utilizamos el comando `show options`:


`msf6 exploit(windows/smb/ms17_010_psexec) > show options`

Esto mostrará las opciones que deben configurarse, como `RHOSTS` (la dirección IP del objetivo) y `LHOST` (la dirección IP de nuestra máquina atacante).

#### Ejecución del Exploit

Una vez configuradas las opciones necesarias, podemos ejecutar un chequeo para asegurarnos de que el servidor es vulnerable:

`msf6 exploit(windows/smb/ms17_010_psexec) > check`

Si el servidor es vulnerable, podemos proceder a ejecutar el exploit con el comando `exploit`:

`msf6 exploit(windows/smb/ms17_010_psexec) > exploit`
![[Pasted image 20240929193736.png]]

Esto debería abrir una sesión de **Meterpreter**, permitiéndonos ejecutar comandos en el sistema comprometido.